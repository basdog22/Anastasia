shortcodeshtml = '';



tinymce.PluginManager.add('shortcodes', function(editor, url) {
    // Add a button that opens a window
    jQuery.get(lara.cms.url+'/backend/shortcodelist',function(response){
        shortcodeshtml = response;

    });
    editor.addButton('shortcodes', {
//        text: 'Load file',
        image: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADlElEQVRYhcWXTYgdRRDHe40e1GAwZmWDcUnQ6K5G0CwGF6L0m/pVzxuWRRAeIjm5iocEJAcFMZcNBvWgYlQ8KRoPCR7U+AEqruAXiAYPIR+uCApiTIxEwxoXE7M+D9aEdpg3b966moKB6e6qrn/Xvz+qnOtRWq3WIuB54Degbd8JVd3unOvrdb6eBbgtcvyPL0mSdf85ABF5zBw+EPU9A7RF5N6FcnIj8A4wJSI3x2PAFNBW1RD1TRiAF2LdEMI48BGwu9FoXF3LObAemIlCOwc87b1fnKbpcuAY0PbeL4tsbjDd6TRNl2ZZ1g/sLFB0GBiudJ4kyTrgVzN4GdgCnLT2j8ApW+n7sd3k5OQ5wEHTm81BAjOqugn4wNpH0jS9siMAVf3MFHe0Wq1FFsY1wB7r/11VXxSRS0oiNwjstoi1galms7nSOefGx8cvMErbwGtV4d9rK7yrOBZCGAKWVIbQOZdlWb+qri6Ze9IAvNXRWERuN6WfvfcD3ZzVlUajca1ROQesr1QWkVdtl+8qG0+S5DJgm9H1FfAl8LGqPpim6dIyG+ATi+yTXdF67weAE8BckWvgHmBaRDbGdJjN/cDXwK2xje2hNvB9COHCrgBE5BrgT2B2ZGTkvMj5BPB5p1Was8tVdb+INAvg5oDZ+OjGKz5XRFREtgJvA78Y4mdzHQv7wSzL+p1zTlVXA28CPwFHVXUXMGjzrQCm49XmtAJHReQNYEsI4RbnXJ8ruTDawKdjY2MX5xOo6uMissFWOWSONwODIYRVBv5QCOFSi9ZDwObcvtlsrgQOFP2o6sMu6nhEVVtJklzhCq8acGB0dPR8+38XmChGEnhUVZ8zkKtE5MN43C6rYRHZoKrbzeexMwA68WqT74v+T2dZdlGJzjBwKGp/UzHfkjN+6wBQ1f0xAO/94qKOiFwFHI7a3/YEoAcK3vs3FKjqHcATMQUv9bIJkyRZm2/CLMv6vfcD892EwDbnnOsTkcY8j+EMcBzYmabpcufqH0PgplJ+/veLqCjxVVw0mM9VDFzX61Wch+v1svHCY/QD8B3dH6MvqPMYRc/xce/9iq5oa4qqXs/f2VT1c4wlJKp6d3EshDBUxX8u3vtlZQmJbfLqhKRGSnYK2NEpJTP6TlOdkr3SEcBZT0ptJbXS8jgKLFRankudwgQg6ruThSpMaoDLS7P7IgBPsZClWZVwtovTqDz/I3J+cr7l+V/knazriRmswgAAAABJRU5ErkJggg==',
        icon: true,
        onclick: function() {
            // Open window
            editor.windowManager.open({
                title: 'Add Shortcode',
                body: [{
                    type: 'container',
                    html: shortcodeshtml
                }],
                width: 700,
                height: 400,
                buttons: [{
                    text: 'Close',
                    onclick: 'close'
                },{
                    text: 'Add Selected',
                    onclick: function(e){
                        var selected = jQuery("#shortcode option:selected").val();
                        editor.insertContent("["+selected+"]");
                        editor.windowManager.close();
                    }
                }]
            });
        }
    });

    // Adds a menu item to the tools menu
    editor.addMenuItem('shortcodes', {
        text: 'Add Shortcode',
        context: 'tools',
        image: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADlElEQVRYhcWXTYgdRRDHe40e1GAwZmWDcUnQ6K5G0CwGF6L0m/pVzxuWRRAeIjm5iocEJAcFMZcNBvWgYlQ8KRoPCR7U+AEqruAXiAYPIR+uCApiTIxEwxoXE7M+D9aEdpg3b966moKB6e6qrn/Xvz+qnOtRWq3WIuB54Degbd8JVd3unOvrdb6eBbgtcvyPL0mSdf85ABF5zBw+EPU9A7RF5N6FcnIj8A4wJSI3x2PAFNBW1RD1TRiAF2LdEMI48BGwu9FoXF3LObAemIlCOwc87b1fnKbpcuAY0PbeL4tsbjDd6TRNl2ZZ1g/sLFB0GBiudJ4kyTrgVzN4GdgCnLT2j8ApW+n7sd3k5OQ5wEHTm81BAjOqugn4wNpH0jS9siMAVf3MFHe0Wq1FFsY1wB7r/11VXxSRS0oiNwjstoi1galms7nSOefGx8cvMErbwGtV4d9rK7yrOBZCGAKWVIbQOZdlWb+qri6Ze9IAvNXRWERuN6WfvfcD3ZzVlUajca1ROQesr1QWkVdtl+8qG0+S5DJgm9H1FfAl8LGqPpim6dIyG+ATi+yTXdF67weAE8BckWvgHmBaRDbGdJjN/cDXwK2xje2hNvB9COHCrgBE5BrgT2B2ZGTkvMj5BPB5p1Was8tVdb+INAvg5oDZ+OjGKz5XRFREtgJvA78Y4mdzHQv7wSzL+p1zTlVXA28CPwFHVXUXMGjzrQCm49XmtAJHReQNYEsI4RbnXJ8ruTDawKdjY2MX5xOo6uMissFWOWSONwODIYRVBv5QCOFSi9ZDwObcvtlsrgQOFP2o6sMu6nhEVVtJklzhCq8acGB0dPR8+38XmChGEnhUVZ8zkKtE5MN43C6rYRHZoKrbzeexMwA68WqT74v+T2dZdlGJzjBwKGp/UzHfkjN+6wBQ1f0xAO/94qKOiFwFHI7a3/YEoAcK3vs3FKjqHcATMQUv9bIJkyRZm2/CLMv6vfcD892EwDbnnOsTkcY8j+EMcBzYmabpcufqH0PgplJ+/veLqCjxVVw0mM9VDFzX61Wch+v1svHCY/QD8B3dH6MvqPMYRc/xce/9iq5oa4qqXs/f2VT1c4wlJKp6d3EshDBUxX8u3vtlZQmJbfLqhKRGSnYK2NEpJTP6TlOdkr3SEcBZT0ptJbXS8jgKLFRankudwgQg6ruThSpMaoDLS7P7IgBPsZClWZVwtovTqDz/I3J+cr7l+V/knazriRmswgAAAABJRU5ErkJggg==',
        icon: true,
        onclick: function() {
            // Open window
            editor.windowManager.open({
                title: 'Add Shortcode',
                body: [{
                    type: 'container',
                    html: shortcodeshtml
                }],
                width: 700,
                height: 400,
                buttons: [{
                    text: 'Close',
                    onclick: 'close'
                },{
                    text: 'Add Selected',
                    onclick: function(e){
                        var selected = jQuery("#shortcode option:selected").val();
                        editor.insertContent("["+selected+"]");
                        editor.windowManager.close();
                    }
                }]
            });
        }
    });
});
